# MongoDB ν†µν•© κ°λ° λ…μ„Έμ„

## π“‹ ν”„λ΅μ νΈ κ°μ”
Blink-Fit λ κ±΄κ°• μ• ν”λ¦¬μΌ€μ΄μ…μ„ μ„ν•΄ Firebase Functionsμ™€ MongoDB Atlas ν΄λΌμ°λ“ λ°μ΄ν„°λ² μ΄μ¤λ¥Ό ν†µν•©ν•μ—¬ μ‚¬μ©μ λ°μ΄ν„°, ν€΄μ¦ μ‘λ‹µ, AI μƒμ„± μ¶”μ²μ‚¬ν•­μ„ μ €μ¥ν•λ” μ‹μ¤ν… κµ¬μ¶•.

## π― λ©ν‘
- μ‚¬μ©μ ν€΄μ¦ μ‘λ‹µ λ° μ„ νΈλ„ μ €μ¥
- AI μƒμ„± κ°μΈν™” κ°€μ΄λ“ λ³΄κ΄€
- μ‚¬μ©μ μƒνΈμ‘μ© νμ¤ν† λ¦¬ μ¶”μ 
- λ¶„μ„μ„ μ„ν• λ°μ΄ν„° μ§€μ†μ„± κµ¬ν„
- λ°μ΄ν„° μΌκ΄€μ„± λ° μ•μ •μ„± μ μ§€

## π—οΈ μ•„ν‚¤ν…μ² μ„¤κ³„

### ν„μ¬ μ•„ν‚¤ν…μ²
```
ν΄λΌμ΄μ–ΈνΈ β†’ Firebase Functions β†’ Gemini AI β†’ μ‘λ‹µ
```

### λ©ν‘ μ•„ν‚¤ν…μ²
```
ν΄λΌμ΄μ–ΈνΈ β†’ Firebase Functions β†’ Gemini AI β†’ μ‘λ‹µ
                β†“
            MongoDB Atlas (λ°μ΄ν„° μ €μ¥μ†)
```

### κΈ°μ  μ¤νƒ
- **API κ³„μΈµ**: Firebase Functions (κΈ°μ΅΄)
- **λ°μ΄ν„°λ² μ΄μ¤**: MongoDB Atlas (ν΄λΌμ°λ“)
- **ODM**: Mongoose (μ¤ν‚¤λ§ κ΄€λ¦¬)
- **μ—°κ²° ν’€**: Mongoose λ‚΄μ¥ μ—°κ²° ν’€λ§
- **ν™κ²½ μ„¤μ •**: Firebase Secret Manager (μκ²©μ¦λ… κ΄€λ¦¬)

## π“ λ°μ΄ν„° λ¨λΈ

### 1. μ‚¬μ©μ ν”„λ΅ν•„ λ¨λΈ
```typescript
interface UserProfile {
  _id: ObjectId;
  userId: string;           // κ³ μ  μ‹λ³„μ
  createdAt: Date;          // μƒμ„±μΌ
  updatedAt: Date;          // μμ •μΌ
  lastActiveAt: Date;       // λ§μ§€λ§‰ ν™λ™μΌ
  preferences?: {           // μ‚¬μ©μ μ„ νΈλ„
    breakPreference?: string;   // ν΄μ‹ μ„ νΈλ„
    favoriteSnack?: string;     // μ„ νΈ κ°„μ‹
    favoritePlace?: string;     // μ„ νΈ μ¥μ†
  };
}
```

### 2. ν€΄μ¦ μ‘λ‹µ λ¨λΈ
```typescript
interface QuizResponse {
  _id: ObjectId;
  userId: string;           // μ‚¬μ©μ ID
  sessionId: string;        // κ³ μ  μ„Έμ… μ‹λ³„μ
  responses: QuizAnswer[];  // ν€΄μ¦ λ‹µλ³€ λ°°μ—΄
  subjective?: SubjectiveData;  // μ£Όκ΄€μ  λ°μ΄ν„°
  analysisResults: {        // LLM λ¶„μ„ κ²°κ³Ό
    screenTimeRisk: number;     // ν™”λ©΄ μ‹κ°„ μ„ν—λ„
    eyeStrainLevel: number;     // λ ν”Όλ΅λ„
    breakHabits: number;        // ν΄μ‹ μµκ΄€ μ μ
    physicalSymptoms: number;   // μ‹ μ²΄ μ¦μƒ μ μ
    deviceUsage: number;        // κΈ°κΈ° μ‚¬μ© ν¨ν„΄
    overallRiskProfile: string; // μ „μ²΄ μ„ν—λ„ ν”„λ΅ν•„ (low/medium/high)
  };
  submittedAt: Date;        // μ μ¶μΌ
}

interface QuizAnswer {
  questionId: number;       // μ§λ¬Έ ID
  question: string;         // μ§λ¬Έ λ‚΄μ©
  answer: string;          // λ‹µλ³€
  level: number;           // μ„ν—λ„ λ λ²¨ (1-5)
  analysisNote?: string;   // LLMμ ν•΄λ‹Ή λ‹µλ³€μ— λ€ν• λ¶„μ„ λ…ΈνΈ
}
```

### 3. μƒμ„±λ κ°€μ΄λ“ λ¨λΈ
```typescript
interface GeneratedGuide {
  _id: ObjectId;
  userId: string;           // μ‚¬μ©μ ID
  quizResponseId: ObjectId; // ν€΄μ¦ μ‘λ‹µ μ°Έμ΅°
  guide: {                  // LLM μƒμ„± κ°μΈν™” κ°€μ΄λ“
    workDuration: string;       // μ‘μ—… μ‹κ°„ (μ: "25 minutes")
    breakDuration: string;      // ν΄μ‹ μ‹κ°„ (μ: "5 minutes")
    screenTimeLimit: string;    // ν™”λ©΄ μ‹κ°„ μ ν• (μ: "6 hours/day")
    exercises: string[];        // κ°μΈν™”λ μ΄λ™ λ©λ΅ (3-4κ°)
  };
  llmReasoning?: string;    // LLMμ μ¶”μ² κ·Όκ±°/μ„¤λ…
  promptUsed: string;       // μ‚¬μ©λ ν”„λ΅¬ν”„νΈ (λ””λ²„κΉ…/κ°μ„ μ©)
  source: 'Gemini AI' | 'Enhanced Fallback Algorithm';  // μƒμ„± μ†μ¤
  generatedAt: Date;        // μƒμ„±μΌ
  personalizedFactors: {    // κ°μΈν™” κ³ λ ¤ μ”μ†
    symptomFocus: string[];     // μ£Όμ” μ¦μƒ ν¬μ»¤μ¤
    preferencesApplied: string[]; // μ μ©λ μ‚¬μ©μ μ„ νΈλ„
    adaptationLevel: string;    // μ μ‘ μμ¤€ (beginner/intermediate/advanced)
  };
}
```

### 4. μ΄λ™ νμ¤ν† λ¦¬ λ¨λΈ
```typescript
interface ExerciseHistory {
  _id: ObjectId;
  userId: string;           // μ‚¬μ©μ ID
  exerciseGuide: {          // LLM μƒμ„± μ΄λ™ κ°€μ΄λ“
    message: string;            // κ°μΈν™”λ λ©”μ‹μ§€
    activityType: string;       // ν™λ™ μ ν• (eye_exercise/physical_movement/relaxation/combination)
    duration: string;           // μ¶”μ² μ§€μ† μ‹κ°„
    tips: string[];            // κµ¬μ²΄μ μΈ ν λ©λ΅
    personalizationNote?: string; // κ°μΈν™” μ μ© μ‚¬ν•­
  };
  userPreferences?: string[];   // μ‚¬μ©μ μ„ νΈλ„
  breakCount: number;       // ν΄μ‹ νμ
  workDuration?: number;    // μ‘μ—… μ§€μ† μ‹κ°„ (λ¶„)
  contextualFactors: {      // μƒν™©λ³„ κ³ λ ¤ μ”μ†
    timeOfDay?: string;         // μ‹κ°„λ€
    previousActivity?: string;  // μ΄μ „ ν™λ™
    stressLevel?: number;      // μ¤νΈλ μ¤ μμ¤€ (1-5)
  };
  llmPromptUsed?: string;   // μ‚¬μ©λ LLM ν”„λ΅¬ν”„νΈ
  source: 'Gemini AI' | 'Enhanced Fallback Algorithm';  // μƒμ„± μ†μ¤
  requestedAt: Date;        // μ”μ²­μΌ
  effectiveness?: {         // ν¨κ³Όμ„± μ¶”μ  (μ„ νƒμ )
    userRating?: number;        // μ‚¬μ©μ ν‰κ°€ (1-5)
    completionStatus?: string;  // μ™„λ£ μƒνƒ
  };
}
```

### 5. LLM μƒνΈμ‘μ© λ΅κ·Έ λ¨λΈ (μ‹ κ·)
```typescript
interface LLMInteractionLog {
  _id: ObjectId;
  userId: string;           // μ‚¬μ©μ ID
  interactionType: 'guide_generation' | 'exercise_recommendation' | 'conversation';
  prompt: string;           // μ „μ†΅λ ν”„λ΅¬ν”„νΈ
  response: string;         // LLM μ‘λ‹µ
  processingTime: number;   // μ²λ¦¬ μ‹κ°„ (ms)
  tokenUsage?: {            // ν† ν° μ‚¬μ©λ‰ (μ„ νƒμ )
    promptTokens: number;
    responseTokens: number;
    totalTokens: number;
  };
  modelInfo: {              // λ¨λΈ μ •λ³΄
    modelName: string;          // μ‚¬μ©λ λ¨λΈλ…
    temperature: number;        // μ°½μμ„± μ„¤μ •
    maxTokens: number;         // μµλ€ ν† ν°
  };
  success: boolean;         // μ„±κ³µ μ—¬λ¶€
  errorDetails?: string;    // μ—λ¬ μ •λ³΄ (μ‹¤ν¨ μ‹)
  timestamp: Date;          // μƒνΈμ‘μ© μ‹μ 
}
```

### 6. API μ‚¬μ© λ¶„μ„ λ¨λΈ (κΈ°μ΅΄ μ—…λ°μ΄νΈ)
```typescript
interface APIUsage {
  _id: ObjectId;
  endpoint: string;         // API μ—”λ“ν¬μΈνΈ
  method: string;           // HTTP λ©”μ†λ“
  userId?: string;          // μ‚¬μ©μ ID (μ„ νƒ)
  sessionId?: string;       // μ„Έμ… ID (μ„ νƒ)
  responseTime: number;     // μ‘λ‹µ μ‹κ°„
  success: boolean;         // μ„±κ³µ μ—¬λ¶€
  llmUsage?: {              // LLM μ‚¬μ© μ •λ³΄ (ν•΄λ‹Ήλλ” κ²½μ°)
    used: boolean;              // LLM μ‚¬μ© μ—¬λ¶€
    model: string;             // μ‚¬μ©λ λ¨λΈ
    processingTime: number;     // LLM μ²λ¦¬ μ‹κ°„
    fallbackUsed: boolean;     // Fallback μ‚¬μ© μ—¬λ¶€
  };
  source: 'LLM Primary' | 'Enhanced Fallback' | 'Direct API';  // μ‘λ‹µ μ†μ¤
  timestamp: Date;          // νƒ€μ„μ¤νƒ¬ν”„
  userAgent?: string;       // μ‚¬μ©μ μ—μ΄μ „νΈ (μ„ νƒ)
  ipAddress?: string;       // IP μ£Όμ† (μ„ νƒ)
}
```

## π”§ κµ¬ν„ μ „λµ

### 1λ‹¨κ³„: λ°μ΄ν„°λ² μ΄μ¤ μ„¤μ • λ° μ—°κ²°
1. **MongoDB Atlas μ„¤μ •**
   - λ¬΄λ£ ν‹°μ–΄ ν΄λ¬μ¤ν„° μƒμ„±
   - λ„¤νΈμ›ν¬ μ ‘κ·Ό μ„¤μ • (Firebase Functions ν—μ©)
   - μ μ ν• κ¶ν•μ„ κ°€μ§„ λ°μ΄ν„°λ² μ΄μ¤ μ‚¬μ©μ μƒμ„±
   - μ—°κ²° λ¬Έμμ—΄ νλ“

2. **ν™κ²½ μ„¤μ •**
   - MongoDB μ—°κ²° λ¬Έμμ—΄μ„ Firebase Secret Managerμ— μ¶”κ°€
   - ν™κ²½ μ„¤μ • μ—…λ°μ΄νΈ
   - κ°λ° ν™κ²½μ—μ„ μ—°κ²° ν…μ¤νΈ

3. **λ°μ΄ν„°λ² μ΄μ¤ μ„λΉ„μ¤ κµ¬ν„**
   - λ°μ΄ν„°λ² μ΄μ¤ μ—°κ²° μ„λΉ„μ¤ μƒμ„±
   - μ—°κ²° ν’€λ§ κµ¬ν„
   - μ—λ¬ μ²λ¦¬ λ° μ¬μ‹λ„ λ΅μ§ μ¶”κ°€

### 2λ‹¨κ³„: λ°μ΄ν„° λ¨λΈ λ° μ¤ν‚¤λ§
1. **μ¤ν‚¤λ§ μ •μ**
   - λ¨λ“  λ¨λΈμ— λ€ν• Mongoose μ¤ν‚¤λ§ μƒμ„±
   - μ ν¨μ„± κ²€μ‚¬ κ·μΉ™ λ° μΈλ±μ¤ μ¶”κ°€
   - νƒ€μ„μ¤νƒ¬ν”„λ¥Ό μ„ν• λ―Έλ“¤μ›¨μ–΄ κµ¬ν„

2. **Repository ν¨ν„΄**
   - κ° λ¨λΈμ— λ€ν• Repository ν΄λμ¤ μƒμ„±
   - CRUD μ‘μ—… κµ¬ν„
   - λ°μ΄ν„° μ ‘κ·Ό κ³„μΈµ μ¶”μƒν™” μ¶”κ°€

### 3λ‹¨κ³„: API ν†µν•© λ° LLM μµμ ν™”
1. **κΈ°μ΅΄ μ—”λ“ν¬μΈνΈ κ°μ„ **
   - `/api/generate-guide`λ¥Ό μμ •ν•μ—¬ LLM μ‘λ‹µκ³Ό λ¶„μ„ κ²°κ³Ό μ €μ¥
   - `/api/exercise-guidance`λ¥Ό μ—…λ°μ΄νΈν•μ—¬ κ°μΈν™”λ LLM μ¶”μ² μ €μ¥
   - `/api/hello` μ—”λ“ν¬μΈνΈμ— μ‚¬μ©μ μƒνΈμ‘μ© ν¨ν„΄ μ¶”μ  κΈ°λ¥ μ¶”κ°€

2. **μƒλ΅μ΄ LLM μ¤‘μ‹¬ μ—”λ“ν¬μΈνΈ**
   - `GET /api/user/:userId/profile` - μ‚¬μ©μ ν”„λ΅ν•„ λ° LLM μƒνΈμ‘μ© νμ¤ν† λ¦¬ μ΅°ν
   - `GET /api/user/:userId/history` - κ°μΈν™” μ¶”μ² νμ¤ν† λ¦¬ λ° ν¨κ³Όμ„± λ¶„μ„
   - `POST /api/user/:userId/preferences` - μ„ νΈλ„ μ—…λ°μ΄νΈ λ° LLM ν”„λ΅¬ν”„νΈ μµμ ν™”
   - `GET /api/analytics/llm-performance` - LLM μ„±λ¥ λ° μ‚¬μ©λ‰ λ¶„μ„
   - `POST /api/feedback/:guideId` - μ‚¬μ©μ ν”Όλ“λ°±μ„ ν†µν• LLM κ°μ„ 

3. **LLM ν”„λ΅¬ν”„νΈ κ΄€λ¦¬ μ‹μ¤ν…**
   - ν”„λ΅¬ν”„νΈ λ²„μ „ κ΄€λ¦¬ λ° A/B ν…μ¤νΈ
   - μ‚¬μ©μ ν”Όλ“λ°± κΈ°λ° ν”„λ΅¬ν”„νΈ μµμ ν™”
   - μ»¨ν…μ¤νΈλ³„ ν”„λ΅¬ν”„νΈ κ°μΈν™”

### 4λ‹¨κ³„: LLM μ„±λ¥ λ¶„μ„ λ° κ°μΈν™” μµμ ν™”
1. **LLM μƒνΈμ‘μ© λ¶„μ„**
   - ν”„λ΅¬ν”„νΈ ν¨κ³Όμ„± μΈ΅μ •
   - μ‘λ‹µ ν’μ§ ν‰κ°€ μ‹μ¤ν…
   - μ‚¬μ©μ λ§μ΅±λ„ μ¶”μ 
   - ν† ν° μ‚¬μ©λ‰ μµμ ν™”

2. **κ°μΈν™” μ•κ³ λ¦¬μ¦ κ°μ„ **
   - μ‚¬μ©μλ³„ μ„ νΈ ν¨ν„΄ ν•™μµ
   - μ»¨ν…μ¤νΈ μΈμ‹ μ¶”μ² μ‹μ¤ν…
   - μ μ‘ν• ν”„λ΅¬ν”„νΈ μƒμ„±
   - ν”Όλ“λ°± λ£¨ν”„ κµ¬ν„

3. **λ°μ΄ν„° κΈ°λ° μΈμ‚¬μ΄νΈ**
   - μ‚¬μ©μ μ°Έμ—¬ μ§€ν‘ λ¶„μ„
   - κ°€μ¥ ν¨κ³Όμ μΈ μ΄λ™ μ¶”μ² ν¨ν„΄
   - LLM vs Enhanced Fallback μ„±λ¥ λΉ„κµ
   - κ°μΈν™” μ”μ†λ³„ μν–¥λ„ λ¶„μ„

## π“ νμΌ κµ¬μ΅° λ³€κ²½μ‚¬ν•­

```
functions/src/
β”β”€β”€ index.ts                     # μ§„μ…μ 
β”β”€β”€ config/
β”‚   β”β”€β”€ index.ts                # Firebase μ„¤μ • (κΈ°μ΅΄)
β”‚   β”β”€β”€ database.ts             # MongoDB μ—°κ²° μ„¤μ • (μ‹ κ·)
β”‚   β””β”€β”€ llm.ts                  # LLM ν”„λ΅¬ν”„νΈ λ° μ„¤μ • κ΄€λ¦¬ (μ‹ κ·)
β”β”€β”€ models/                     # λ°μ΄ν„°λ² μ΄μ¤ λ¨λΈ (μ‹ κ·)
β”‚   β”β”€β”€ User.ts                 # μ‚¬μ©μ λ¨λΈ
β”‚   β”β”€β”€ QuizResponse.ts         # ν€΄μ¦ μ‘λ‹µ λ¨λΈ (λ¶„μ„ κ²°κ³Ό ν¬ν•¨)
β”‚   β”β”€β”€ GeneratedGuide.ts       # μƒμ„±λ κ°€μ΄λ“ λ¨λΈ (LLM λ©”νƒ€λ°μ΄ν„° ν¬ν•¨)
β”‚   β”β”€β”€ ExerciseHistory.ts      # μ΄λ™ νμ¤ν† λ¦¬ λ¨λΈ (κ°μΈν™” μ •λ³΄ ν¬ν•¨)
β”‚   β”β”€β”€ LLMInteractionLog.ts    # LLM μƒνΈμ‘μ© λ΅κ·Έ (μ‹ κ·)
β”‚   β””β”€β”€ APIUsage.ts             # API μ‚¬μ©λ‰ λ¨λΈ (LLM μ‚¬μ© μ •λ³΄ ν¬ν•¨)
β”β”€β”€ repositories/               # λ°μ΄ν„° μ ‘κ·Ό κ³„μΈµ (μ‹ κ·)
β”‚   β”β”€β”€ UserRepository.ts       # μ‚¬μ©μ Repository
β”‚   β”β”€β”€ QuizRepository.ts       # ν€΄μ¦ Repository
β”‚   β”β”€β”€ GuideRepository.ts      # κ°€μ΄λ“ Repository
β”‚   β”β”€β”€ ExerciseRepository.ts   # μ΄λ™ Repository
β”‚   β”β”€β”€ LLMLogRepository.ts     # LLM λ΅κ·Έ Repository (μ‹ κ·)
β”‚   β””β”€β”€ AnalyticsRepository.ts  # λ¶„μ„ Repository
β”β”€β”€ services/
β”‚   β”β”€β”€ geminiService.ts        # AI μ„λΉ„μ¤ (κΈ°μ΅΄ - λ΅κΉ… κ°•ν™”)
β”‚   β”β”€β”€ databaseService.ts      # λ°μ΄ν„°λ² μ΄μ¤ μ—°κ²° (μ‹ κ·)
β”‚   β”β”€β”€ promptService.ts        # ν”„λ΅¬ν”„νΈ κ΄€λ¦¬ μ„λΉ„μ¤ (μ‹ κ·)
β”‚   β””β”€β”€ personalizationService.ts # κ°μΈν™” μ„λΉ„μ¤ (μ‹ κ·)
β”β”€β”€ controllers/                # μ”μ²­ ν•Έλ“¤λ¬ (κΈ°μ΅΄)
β”‚   β”β”€β”€ helloController.ts      # μƒνΈμ‘μ© λ΅κΉ… μ¶”κ°€
β”‚   β”β”€β”€ guideController.ts      # LLM λ¶„μ„ κ²°κ³Ό μ €μ¥ μ¶”κ°€
β”‚   β”β”€β”€ exerciseController.ts   # κ°μΈν™” λ° ν¨κ³Όμ„± μ¶”μ  μ¶”κ°€
β”‚   β”β”€β”€ userController.ts       # μ‚¬μ©μ κ΄€λ¦¬ (μ‹ κ·)
β”‚   β””β”€β”€ analyticsController.ts  # LLM μ„±λ¥ λ¶„μ„ (μ‹ κ·)
β”β”€β”€ middleware/                 # μ”μ²­ λ―Έλ“¤μ›¨μ–΄ (μ‹ κ·)
β”‚   β”β”€β”€ analytics.ts            # μ‚¬μ©λ‰ μ¶”μ  (LLM μ •λ³΄ ν¬ν•¨)
β”‚   β”β”€β”€ validation.ts           # μ…λ ¥ μ ν¨μ„± κ²€μ‚¬
β”‚   β””β”€β”€ llmMonitoring.ts        # LLM μ„±λ¥ λ¨λ‹ν„°λ§ (μ‹ κ·)
β”β”€β”€ routes/
β”‚   β”β”€β”€ index.ts                # λ©”μΈ λΌμ°νΈ (κΈ°μ΅΄)
β”‚   β”β”€β”€ userRoutes.ts           # μ‚¬μ©μ κ΄€λ ¨ λΌμ°νΈ (μ‹ κ·)
β”‚   β””β”€β”€ analyticsRoutes.ts      # λ¶„μ„ λΌμ°νΈ (μ‹ κ·)
β”β”€β”€ types/
β”‚   β”β”€β”€ index.ts                # μΌλ° νƒ€μ… (κΈ°μ΅΄)
β”‚   β”β”€β”€ database.ts             # λ°μ΄ν„°λ² μ΄μ¤ νƒ€μ… (μ‹ κ·)
β”‚   β””β”€β”€ llm.ts                  # LLM κ΄€λ ¨ νƒ€μ… (μ‹ κ·)
β””β”€β”€ utils/
    β”β”€β”€ helpers.ts              # μΌλ° μ ν‹Έλ¦¬ν‹° (κ°μ„ λ Fallback μ•κ³ λ¦¬μ¦)
    β”β”€β”€ dataUtils.ts            # λ°μ΄ν„° μ²λ¦¬ μ ν‹Έλ¦¬ν‹° (μ‹ κ·)
    β”β”€β”€ promptUtils.ts          # ν”„λ΅¬ν”„νΈ μƒμ„± μ ν‹Έλ¦¬ν‹° (μ‹ κ·)
    β””β”€β”€ llmAnalytics.ts         # LLM λ¶„μ„ μ ν‹Έλ¦¬ν‹° (μ‹ κ·)
```

## π” λ³΄μ• κ³ λ ¤μ‚¬ν•­

### μ—°κ²° λ³΄μ•
- MongoDB Atlas λ‚΄μ¥ λ³΄μ• κΈ°λ¥ μ‚¬μ©
- Firebase Secret Managerμ— μ—°κ²° λ¬Έμμ—΄ μ €μ¥
- Firebase Functionsμ— λ€ν• IP ν™”μ΄νΈλ¦¬μ¤νΈ ν™μ„±ν™”
- κ°•λ ¥ν• μΈμ¦ μκ²©μ¦λ… μ‚¬μ©

### λ°μ΄ν„° λ³΄νΈ
- API λ λ²¨μ—μ„ λ°μ΄ν„° μ ν¨μ„± κ²€μ‚¬ κµ¬ν„
- Mongoose μ¤ν‚¤λ§ μ ν¨μ„± κ²€μ‚¬ μ‚¬μ©
- μ‚¬μ©μ μ…λ ¥ λ°μ΄ν„° μ •μ 
- μ”μ²­ μ ν• κµ¬ν„

### κ°μΈμ •λ³΄ λ³΄νΈ κ·μ • μ¤€μ
- μµμ†ν•μ μ‚¬μ©μ λ°μ΄ν„° μ €μ¥
- λ°μ΄ν„° λ³΄μ΅΄ μ •μ±… κµ¬ν„
- μ‚¬μ©μ λ°μ΄ν„° μ‚­μ  κΈ°λ¥ μ¶”κ°€
- GDPR μ¤€μ κ³ λ ¤μ‚¬ν•­ ν™•μΈ

## π€ κ°λ° κ³„ν

### 1λ‹¨κ³„: ν™κ²½ μ„¤μ • (1μΌμ°¨)
- [ ] MongoDB Atlas κ³„μ • λ° ν΄λ¬μ¤ν„° μƒμ„±
- [ ] λ„¤νΈμ›ν¬ μ ‘κ·Ό λ° μΈμ¦ μ„¤μ •
- [ ] Firebase Secret Managerμ— μ—°κ²° λ¬Έμμ—΄ μ¶”κ°€
- [ ] ν•„μ”ν• npm ν¨ν‚¤μ§€ μ„¤μΉ

### 2λ‹¨κ³„: λ°μ΄ν„°λ² μ΄μ¤ κΈ°λ° κµ¬μ¶• (1-2μΌμ°¨)
- [ ] λ°μ΄ν„°λ² μ΄μ¤ μ—°κ²° μ„λΉ„μ¤ μƒμ„±
- [ ] κΈ°λ³Έ μ—°κ²° ν…μ¤νΈ κµ¬ν„
- [ ] Mongoose μ¤ν‚¤λ§ μ„¤μ •
- [ ] λ΅μ»¬ ν™κ²½μ—μ„ μ—°κ²° ν…μ¤νΈ

### 3λ‹¨κ³„: Repository κ³„μΈµ λ° LLM ν†µν•© (2-3μΌμ°¨)
- [ ] Repository ν¨ν„΄ κµ¬ν„
- [ ] κ° λ¨λΈμ— λ€ν• CRUD μ‘μ—… μƒμ„± (LLM λ©”νƒ€λ°μ΄ν„° ν¬ν•¨)
- [ ] LLM μƒνΈμ‘μ© λ΅κΉ… μ‹μ¤ν… κµ¬ν„
- [ ] μ—λ¬ μ²λ¦¬ λ° μ ν¨μ„± κ²€μ‚¬ μ¶”κ°€
- [ ] Repositoryμ— λ€ν• λ‹¨μ„ ν…μ¤νΈ μ‘μ„±

### 4λ‹¨κ³„: API ν†µν•© λ° κ°μΈν™” κ°•ν™” (3-4μΌμ°¨)
- [ ] κΈ°μ΅΄ μ»¨νΈλ΅¤λ¬μ— LLM λ¶„μ„ κ²°κ³Ό μ €μ¥ κΈ°λ¥ μ¶”κ°€
- [ ] κ°μΈν™”λ ν”„λ΅¬ν”„νΈ μƒμ„± μ‹μ¤ν… κµ¬ν„
- [ ] μƒλ΅μ΄ μ‚¬μ©μ κ΄€λ¦¬ λ° λ¶„μ„ μ—”λ“ν¬μΈνΈ κµ¬ν„
- [ ] LLM μ„±λ¥ λ¨λ‹ν„°λ§ λ―Έλ“¤μ›¨μ–΄ μ¶”κ°€
- [ ] λ°μ΄ν„°λ² μ΄μ¤ ν†µν•©μΌλ΅ λ¨λ“  μ—”λ“ν¬μΈνΈ ν…μ¤νΈ

### 5λ‹¨κ³„: LLM μµμ ν™” λ° ν…μ¤νΈ (4-5μΌμ°¨)
- [ ] μ‹¤μ  μ‚¬μ©μ λ°μ΄ν„°λ΅ κ°μΈν™” μ•κ³ λ¦¬μ¦ ν…μ¤νΈ
- [ ] ν”„λ΅¬ν”„νΈ ν¨κ³Όμ„± λ¶„μ„ λ° μµμ ν™”
- [ ] LLM vs Enhanced Fallback μ„±λ¥ λΉ„κµ λ¶„μ„
- [ ] μ—λ¬ μ²λ¦¬ λ° λ³µκµ¬ μ‹λ‚λ¦¬μ¤ κ°μ„ 
- [ ] ν¬κ΄„μ μΈ λ¬Έμ„ μ—…λ°μ΄νΈ (LLM μ‚¬μ©λ²• ν¬ν•¨)

## π“¦ ν•„μ”ν• μΆ…μ†μ„±

```json
{
  "dependencies": {
    "mongoose": "^8.0.0",
    "joi": "^17.0.0",
    "lodash": "^4.17.21"
  },
  "devDependencies": {
    "@types/lodash": "^4.14.202"
  }
}
```

## π§ ν…μ¤νΈ μ „λµ

### λ‹¨μ„ ν…μ¤νΈ
- Repository λ©”μ†λ“
- λ°μ΄ν„°λ² μ΄μ¤ μ—°κ²° μ²λ¦¬
- λ°μ΄ν„° μ ν¨μ„± κ²€μ‚¬ λ΅μ§
- μ—λ¬ μ‹λ‚λ¦¬μ¤

### ν†µν•© ν…μ¤νΈ
- μ—”λ“ν¬μ—”λ“ API ν”λ΅μ°
- λ°μ΄ν„°λ² μ΄μ¤ μ‘μ—…
- μ—λ¬ μ²λ¦¬
- μ„±λ¥ λ²¤μΉλ§ν¬

### λ¶€ν• ν…μ¤νΈ
- μ—°κ²° ν’€λ§ ν¨μ¨μ„±
- λ™μ‹ μ”μ²­ μ²λ¦¬
- λ°μ΄ν„°λ² μ΄μ¤ μΏΌλ¦¬ μ„±λ¥

## π“ μ„±κ³µ μ§€ν‘

### μ„±λ¥
- λ°μ΄ν„°λ² μ΄μ¤ μ—°κ²° μ‹κ°„ < 500ms
- μΏΌλ¦¬ μ‘λ‹µ μ‹κ°„ < 200ms
- LLM μ‘λ‹µ μ‹κ°„ < 3μ΄ (95%ile)
- μ—°κ²° λ„μ λλ” νƒ€μ„μ•„μ›ƒ μ—†μ

### LLM ν¨κ³Όμ„±
- LLM μ„±κ³µλ¥  > 95% (Fallback λΉ„μ¨ < 5%)
- κ°μΈν™” μ •ν™•λ„ ν–¥μƒ μΈ΅μ • κ°€λ¥
- μ‚¬μ©μ λ§μ΅±λ„ > 4.0/5.0 (ν”Όλ“λ°± κΈ°λ°)
- ν”„λ΅¬ν”„νΈ μµμ ν™”λ¥Ό ν†µν• ν† ν° μ‚¬μ©λ‰ ν¨μ¨μ„± κ°μ„ 

### μ•μ •μ„±
- λ°μ΄ν„°λ² μ΄μ¤ μ‘μ—… 99.9% κ°€λ™μ‹κ°„
- LLM μ„λΉ„μ¤ μ¥μ•  μ‹ Enhanced Fallback μλ™ μ „ν™
- μ—°κ²° μ‹¤ν¨ μ‹ μλ™ μ¬μ‹λ„
- λ°μ΄ν„°λ² μ΄μ¤ μ‚¬μ© λ¶κ°€ μ‹ μ°μ•„ν• μ„±λ¥ μ €ν•

### λ°μ΄ν„° ν’μ§ λ° κ°μΈν™”
- 100% λ°μ΄ν„° μ ν¨μ„± κ²€μ‚¬ μ¤€μ
- LLM μ‘λ‹µ ν’μ§ λ¨λ‹ν„°λ§ μ‹μ¤ν… μ΄μ
- κ°μΈν™” μ”μ† μ μ©λ¥  > 80%
- λ°μ΄ν„° μ†μƒ μ‚¬κ³  0κ±΄
- μ μ ν• μ—λ¬ λ΅κΉ… λ° λ¨λ‹ν„°λ§

## π”„ λ§μ΄κ·Έλ μ΄μ… μ „λµ

### κ°λ° λ‹¨κ³„
- κΈ°μ΅΄ μ‹μ¤ν…κ³Ό λ³‘ν–‰ μ‹¤ν–‰
- μƒν” λ°μ΄ν„°λ΅ ν…μ¤νΈ
- λ°μ΄ν„° λ¬΄κ²°μ„± κ²€μ¦

### ν”„λ΅λ•μ… λ°°ν¬
- λ°μ΄ν„°λ² μ΄μ¤ ν†µν•© λ°°ν¬
- μ„±λ¥ μ§€ν‘ λ¨λ‹ν„°λ§
- κΈ°λ¥ ν”λκ·Έλ¥Ό ν†µν• μ μ§„μ  λ΅¤μ•„μ›ƒ

### λ΅¤λ°± κ³„ν
- κΈ°μ΅΄ κΈ°λ¥ μ μ§€
- λ°μ΄ν„°λ² μ΄μ¤ μ‘μ—…μ„ κ°μ„ μ‚¬ν•­μΌλ΅ μ²λ¦¬
- ν•„μ”μ‹ λ°μ΄ν„°λ² μ΄μ¤ κΈ°λ¥ λΉ„ν™μ„±ν™” κ°€λ¥

## π“ λ¬Έμ„ μ—…λ°μ΄νΈ

### κΈ°μ  λ¬Έμ„
- λ°μ΄ν„°λ² μ΄μ¤ μ¤ν‚¤λ§ λ¬Έμ„
- API μ—”λ“ν¬μΈνΈ μ—…λ°μ΄νΈ
- Repository μ‚¬μ© μμ 
- μ—λ¬ μ²λ¦¬ κ°€μ΄λ“

### μ‚¬μ©μ λ¬Έμ„
- MongoDB μ„¤μ •μ΄ ν¬ν•¨λ README μ—…λ°μ΄νΈ
- ν™κ²½ μ„¤μ • κ°€μ΄λ“
- λ¬Έμ  ν•΄κ²° μ„Ήμ… μ—…λ°μ΄νΈ

---

## β΅ λΉ λ¥Έ μ‹μ‘ μ”μ•½

1. **MongoDB Atlas μ„¤μ •** - ν΄λ¬μ¤ν„° μƒμ„± λ° μ—°κ²° λ¬Έμμ—΄ νλ“
2. **μΆ…μ†μ„± μ„¤μΉ** - mongoose λ° μ ν¨μ„± κ²€μ‚¬ λΌμ΄λΈλ¬λ¦¬ μ¶”κ°€
3. **LLM λ¨λΈ λ° Repository μƒμ„±** - κ°μΈν™” λ©”νƒ€λ°μ΄ν„°λ¥Ό ν¬ν•¨ν• λ°μ΄ν„° μ¤ν‚¤λ§ μ •μ
4. **μ»¨νΈλ΅¤λ¬ μ—…λ°μ΄νΈ** - LLM λ¶„μ„ κ²°κ³Ό λ° μƒνΈμ‘μ© λ΅κΉ… ν†µν•©
5. **κ°μΈν™” μ‹μ¤ν… κµ¬ν„** - ν”„λ΅¬ν”„νΈ κ΄€λ¦¬ λ° μ‚¬μ©μλ³„ μµμ ν™” μ‹μ¤ν…
6. **ν†µν•© ν…μ¤νΈ** - LLM μ„±λ¥ λ° κ°μΈν™” ν¨κ³Όμ„± κ²€μ¦
7. **λ°°ν¬ λ° λ¨λ‹ν„°λ§** - LLM μ„±λ¥ μ§€ν‘ λ° μ‚¬μ©μ λ§μ΅±λ„ λ¨λ‹ν„°λ§κ³Ό ν•¨κ» λ΅¤μ•„μ›ƒ

μ΄ λ…μ„Έμ„λ” κΈ°μ΅΄ Firebase Functions μ•„ν‚¤ν…μ²μ™€ MongoDB Atlasλ¥Ό ν†µν•©ν•λ©΄μ„ **LLM κΈ°λ° κ°μΈν™” μ‹μ¤ν…**μ„ κµ¬μ¶•ν•μ—¬ μ‚¬μ©μλ³„ λ§μ¶¤ν• λ κ±΄κ°• κ΄€λ¦¬ μ„λΉ„μ¤λ¥Ό μ κ³µν•κΈ° μ„ν• ν¬κ΄„μ μΈ λ΅λ“λ§µμ„ μ κ³µν•©λ‹λ‹¤.
